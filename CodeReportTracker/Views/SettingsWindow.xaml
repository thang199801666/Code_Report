<Window x:Class="CodeReportTracker.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="Settings"
        Width="720"
        Height="460"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        MinWidth="480"
        MinHeight="320">
    <Window.Resources>
        <x:Array x:Key="EntryTypes" Type="{x:Type sys:String}">
            <sys:String>ER</sys:String>
            <sys:String>ESR</sys:String>
            <sys:String>Other</sys:String>
            <sys:String>Folder</sys:String>
        </x:Array>
    </Window.Resources>

    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <GroupBox Header="Link Settings (table)" Grid.Row="0" Margin="0,0,0,8">
            <DataGrid x:Name="dgSettings"
                      ItemsSource="{Binding Settings}"
                      AutoGenerateColumns="False"
                      CanUserAddRows="True"
                      CanUserDeleteRows="True"
                      Margin="4"
                      IsReadOnly="False" RowHeaderWidth="0">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Web Name" 
                                        Binding="{Binding Name, Mode=TwoWay}" 
                                        Width="100"/>
                    <DataGridComboBoxColumn Header="Type"
                                            SelectedItemBinding="{Binding Type, Mode=TwoWay}"
                                            ItemsSource="{StaticResource EntryTypes}"
                                            Width="80"/>
                    <!-- Link column rendered as clickable hyperlink -->
                    <DataGridTemplateColumn Header="Link"
                                            Width="*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <!-- Single root element for the DataTemplate -->
                                <TextBlock TextTrimming="CharacterEllipsis">
                                    <TextBlock.ToolTip>
                                        <ToolTip>
                                            <TextBlock Text="{Binding Link}" TextWrapping="Wrap"/>
                                        </ToolTip>
                                    </TextBlock.ToolTip>
                                    <Hyperlink NavigateUri="{Binding Link}"
                                               RequestNavigate="Hyperlink_RequestNavigate">
                                        <Run Text="{Binding Link}" />
                                    </Hyperlink>
                                </TextBlock>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- PdfFolder rendered as clickable text that opens folder when clicked -->
                    <DataGridTemplateColumn Header="PDF Folder Link" 
                                            Width="*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock TextTrimming="CharacterEllipsis">
                                    <TextBlock.ToolTip>
                                        <ToolTip>
                                            <TextBlock Text="{Binding PdfFolder}" TextWrapping="Wrap"/>
                                        </ToolTip>
                                    </TextBlock.ToolTip>
                                    <Hyperlink Click="PdfFolder_Click">
                                        <Run Text="{Binding PdfFolder}" />
                                    </Hyperlink>
                                </TextBlock>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>

        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Grid.Row="1" Margin="0,8,0,0">
            <Button Width="84" Margin="6,0,0,0" Click="Save_Click">Save</Button>
            <Button Width="84" Margin="6,0,0,0" Click="Cancel_Click">Cancel</Button>
        </StackPanel>
    </Grid>
</Window>