<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        x:Class="CodeReportTracker.ManualWindow"
        Title="User Manual - CodeReportTracker"
        Width="610"
        Height="699"
        WindowStartupLocation="CenterOwner"
        Icon="pack://application:,,,/WinUx.Styles;component/Resources/Report_Tracker.png"
        Background="{DynamicResource WindowBackgroundBrush}">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/WinUx.Styles;component/Themes/Generic.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
                <Setter Property="FontSize" Value="18"/>
                <Setter Property="FontWeight" Value="Bold"/>
                <Setter Property="Foreground" Value="#2E4368"/>
                <Setter Property="Margin" Value="0,20,0,10"/>
            </Style>

            <Style x:Key="SubHeaderStyle" TargetType="TextBlock">
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="Foreground" Value="#4A5F8C"/>
                <Setter Property="Margin" Value="0,15,0,8"/>
            </Style>

            <Style x:Key="BodyTextStyle" TargetType="TextBlock">
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="TextWrapping" Value="Wrap"/>
                <Setter Property="Foreground" Value="#333333"/>
                <Setter Property="LineHeight" Value="20"/>
                <Setter Property="Margin" Value="0,0,0,10"/>
            </Style>

            <Style x:Key="BulletTextStyle" TargetType="TextBlock">
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="TextWrapping" Value="Wrap"/>
                <Setter Property="Foreground" Value="#333333"/>
                <Setter Property="LineHeight" Value="18"/>
                <Setter Property="Margin" Value="20,2,0,2"/>
            </Style>

            <Style x:Key="CodeTextStyle" TargetType="TextBlock">
                <Setter Property="FontFamily" Value="Consolas"/>
                <Setter Property="FontSize" Value="11"/>
                <Setter Property="Background" Value="#F5F5F5"/>
                <Setter Property="Foreground" Value="#D73A49"/>
                <Setter Property="Padding" Value="4,2"/>
                <Setter Property="Margin" Value="20,0,0,5"/>
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" 
                Background="#2E4368" 
                Padding="15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Image Grid.Column="0"
                       Source="pack://application:,,,/WinUx.Styles;component/Resources/Report_Tracker.png"
                       Width="48"
                       Height="48"
                       Margin="0,0,15,0"
                       VerticalAlignment="Center"/>

                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                    <TextBlock Text="CodeReportTracker User Manual"
                               FontSize="24"
                               FontWeight="Bold"
                               Foreground="White"/>
                    <TextBlock Text="Comprehensive guide for managing code reports"
                               FontSize="12"
                               Foreground="#CCCCCC"
                               Margin="0,4,0,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Content -->
        <ScrollViewer Grid.Row="1" 
                      VerticalScrollBarVisibility="Auto"
                      Padding="20">
            <StackPanel>
                <!-- Overview -->
                <TextBlock Text="Overview" Style="{StaticResource SectionHeaderStyle}"/>
                <TextBlock Style="{StaticResource BodyTextStyle}">
                    CodeReportTracker is a desktop application for managing and tracking code reports. 
                    It provides tools for organizing reports, checking links, updating data, managing PDF files, and exporting to Excel.
                </TextBlock>

                <!-- Getting Started -->
                <TextBlock Text="Getting Started" Style="{StaticResource SectionHeaderStyle}"/>

                <TextBlock Text="First Launch" Style="{StaticResource SubHeaderStyle}"/>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Launch the application to see the main window with ribbon toolbar</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• The console panel at the bottom shows operation logs</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Window position and size are automatically saved</TextBlock>

                <TextBlock Text="Configuration" Style="{StaticResource SubHeaderStyle}"/>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Click Settings in the ribbon to configure web scraping</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Add URL patterns and selectors for your code report sources</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Settings are saved automatically to settings.json</TextBlock>

                <!-- Main Features -->
                <TextBlock Text="Main Features" Style="{StaticResource SectionHeaderStyle}"/>

                <TextBlock Text="1. File Operations" Style="{StaticResource SubHeaderStyle}"/>
                <TextBlock Style="{StaticResource BodyTextStyle}">
                    Open, save, and manage code report files (.crp format).
                </TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Open: Load existing .crp files</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Save (Ctrl+S): Quick save to current file</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Save As: Save to a new location or create backups</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Auto-save prompt: Warns before closing with unsaved changes</TextBlock>

                <TextBlock Text="2. Update Operations" Style="{StaticResource SubHeaderStyle}"/>

                <TextBlock Text="Web Update:" Style="{StaticResource BodyTextStyle}" FontWeight="SemiBold"/>
                <TextBlock Style="{StaticResource BodyTextStyle}">
                    Updates code report data by querying online sources configured in Settings.
                </TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Retrieves latest codes, dates, and links</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Color-codes changes (yellow = updated)</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Can be cancelled with Stop button</TextBlock>

                <TextBlock Text="Local Update:" Style="{StaticResource BodyTextStyle}" FontWeight="SemiBold" Margin="0,10,0,5"/>
                <TextBlock Style="{StaticResource BodyTextStyle}">
                    Extracts data from local PDF files without requiring internet connection.
                </TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Reads PDFs from: Pdf Files\[TabName]\</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Parses PDF metadata and content</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Updates grid with extracted information</TextBlock>

                <TextBlock Text="Check Link:" Style="{StaticResource BodyTextStyle}" FontWeight="SemiBold" Margin="0,10,0,5"/>
                <TextBlock Style="{StaticResource BodyTextStyle}">
                    Validates that code report links are accessible.
                </TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Green = Valid link, Red = Broken/missing link</TextBlock>

                <TextBlock Text="3. PDF Management" Style="{StaticResource SubHeaderStyle}"/>

                <TextBlock Text="Download PDFs:" Style="{StaticResource BodyTextStyle}" FontWeight="SemiBold"/>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Downloads PDFs from code report links</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Saves to: Pdf Files\[TabName]\</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Creates folders automatically</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Handles duplicates with numbering</TextBlock>

                <TextBlock Text="Delete PDFs:" Style="{StaticResource BodyTextStyle}" FontWeight="SemiBold" Margin="0,10,0,5"/>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Removes all PDFs for the selected tab</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Requires confirmation before deletion</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Cannot be undone - use with caution</TextBlock>

                <TextBlock Text="4. Export to Excel" Style="{StaticResource SubHeaderStyle}"/>
                <TextBlock Style="{StaticResource BodyTextStyle}">
                    Exports data to Excel with professional formatting.
                </TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• One worksheet per tab</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Color-coded cells (green/red for links, yellow for changes)</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Hyperlinked code report numbers</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Auto-sized columns with filters</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Default filename: CodeReport_YYYYMMDD_HHmmss.xlsx</TextBlock>

                <!-- Color Coding -->
                <TextBlock Text="Color Coding System" Style="{StaticResource SectionHeaderStyle}"/>
                <Grid Margin="20,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="100"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Grid.Column="0" Background="LightGreen" Padding="5" Margin="2">
                        <TextBlock Text="Light Green" FontSize="11" FontWeight="Bold"/>
                    </Border>
                    <TextBlock Grid.Row="0" Grid.Column="1" Text="Valid, verified data (link exists)" 
                               Style="{StaticResource BodyTextStyle}" Margin="10,0,0,0"/>

                    <Border Grid.Row="1" Grid.Column="0" Background="LightCoral" Padding="5" Margin="2">
                        <TextBlock Text="Light Coral" FontSize="11" FontWeight="Bold"/>
                    </Border>
                    <TextBlock Grid.Row="1" Grid.Column="1" Text="Invalid or missing data (broken link)" 
                               Style="{StaticResource BodyTextStyle}" Margin="10,0,0,0"/>

                    <Border Grid.Row="2" Grid.Column="0" Background="Yellow" Padding="5" Margin="2">
                        <TextBlock Text="Yellow" FontSize="11" FontWeight="Bold"/>
                    </Border>
                    <TextBlock Grid.Row="2" Grid.Column="1" Text="Updated/changed data (compared to old values)" 
                               Style="{StaticResource BodyTextStyle}" Margin="10,0,0,0"/>
                </Grid>

                <!-- Keyboard Shortcuts -->
                <TextBlock Text="Keyboard Shortcuts" Style="{StaticResource SectionHeaderStyle}"/>
                <Grid Margin="20,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="120"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Ctrl+S" Style="{StaticResource CodeTextStyle}"/>
                    <TextBlock Grid.Row="0" Grid.Column="1" Text="Save current file" Style="{StaticResource BodyTextStyle}" Margin="10,0,0,0"/>

                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Ctrl+O" Style="{StaticResource CodeTextStyle}"/>
                    <TextBlock Grid.Row="1" Grid.Column="1" Text="Open file dialog" Style="{StaticResource BodyTextStyle}" Margin="10,0,0,0"/>

                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Esc" Style="{StaticResource CodeTextStyle}"/>
                    <TextBlock Grid.Row="2" Grid.Column="1" Text="Stop current operation" Style="{StaticResource BodyTextStyle}" Margin="10,0,0,0"/>
                </Grid>

                <!-- Troubleshooting -->
                <TextBlock Text="Troubleshooting" Style="{StaticResource SectionHeaderStyle}"/>

                <TextBlock Text="PDF Folder Not Found" Style="{StaticResource SubHeaderStyle}"/>
                <TextBlock Style="{StaticResource BodyTextStyle}">
                    Check the console for the folder path, create the folder manually, and place PDF files there.
                </TextBlock>

                <TextBlock Text="No PDF Files Found" Style="{StaticResource SubHeaderStyle}"/>
                <TextBlock Style="{StaticResource BodyTextStyle}">
                    Add PDF files to the folder shown in console. Ensure files have .pdf extension.
                </TextBlock>

                <TextBlock Text="Export Failed" Style="{StaticResource SubHeaderStyle}"/>
                <TextBlock Style="{StaticResource BodyTextStyle}">
                    Close Excel if the target file is open, choose a different location, or run as administrator.
                </TextBlock>

                <TextBlock Text="Links Not Updating" Style="{StaticResource SubHeaderStyle}"/>
                <TextBlock Style="{StaticResource BodyTextStyle}">
                    Check internet connection, verify Settings configuration, and check console for errors.
                </TextBlock>

                <!-- Best Practices -->
                <TextBlock Text="Best Practices" Style="{StaticResource SectionHeaderStyle}"/>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Start with Update to get latest web data</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Download PDFs to archive reports offline</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Use Update Local for offline data extraction</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Export regularly to track changes over time</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Save frequently using Ctrl+S</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Keep PDF folders organized by tab name</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Maintain backup .crp files</TextBlock>

                <!-- File Locations -->
                <TextBlock Text="Important File Locations" Style="{StaticResource SectionHeaderStyle}"/>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Application: CodeReportTracker.exe</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Settings: settings.json (application directory)</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• PDF Storage: Pdf Files\[TabName]\</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Exports: User-selected locations (.xlsx)</TextBlock>
                <TextBlock Style="{StaticResource BulletTextStyle}">• Code Reports: User-selected locations (.crp)</TextBlock>

                <!-- Version Info -->
                <TextBlock Text="Version Information" Style="{StaticResource SectionHeaderStyle}"/>
                <TextBlock Style="{StaticResource BodyTextStyle}">
                    • Framework: .NET 8.0 Windows
                </TextBlock>
                <TextBlock Style="{StaticResource BodyTextStyle}">
                    • UI Framework: WPF (Windows Presentation Foundation)
                </TextBlock>
                <TextBlock Style="{StaticResource BodyTextStyle}">
                    • Libraries: CommunityToolkit.MVVM 8.4.0, Fluent.Ribbon 11.0.2
                </TextBlock>

                <!-- Support -->
                <TextBlock Text="Support" Style="{StaticResource SectionHeaderStyle}"/>
                <TextBlock Style="{StaticResource BodyTextStyle}">
                    For technical support or feature requests, check the console logs and visit the project repository:
                </TextBlock>
                <TextBlock Margin="20,5,0,20">
                    <Hyperlink NavigateUri="https://github.com/thang199801666/Code_Report" 
                               RequestNavigate="Hyperlink_RequestNavigate">
                        https://github.com/thang199801666/Code_Report
                    </Hyperlink>
                </TextBlock>

                <Border Background="#F0F8FF" 
                        BorderBrush="#4A90E2" 
                        BorderThickness="1" 
                        CornerRadius="4" 
                        Padding="15"
                        Margin="0,10,0,20">
                    <StackPanel>
                        <TextBlock Text="💡 Tip" 
                                   FontWeight="Bold" 
                                   FontSize="14" 
                                   Foreground="#2E4368"
                                   Margin="0,0,0,8"/>
                        <TextBlock TextWrapping="Wrap" 
                                   Foreground="#333"
                                   LineHeight="18">
                            The console panel at the bottom of the main window is your primary troubleshooting tool. 
                            All operations are logged with timestamps. Keep an eye on it to monitor progress and identify issues.
                        </TextBlock>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- Footer -->
        <Border Grid.Row="2" 
                Background="#F5F5F5" 
                BorderBrush="#CCCCCC" 
                BorderThickness="0,1,0,0"
                Padding="15,10">
            <Grid>
                <TextBlock Text="© 2024-2026 CodeReportTracker" 
                           FontSize="10" 
                           Foreground="#666"
                           HorizontalAlignment="Left"
                           VerticalAlignment="Center"/>
                <Button Content="Close" 
                        Width="80" 
                        Height="30"
                        HorizontalAlignment="Right"
                        Click="CloseButton_Click"
                        Style="{DynamicResource ButtonStyle}"/>
            </Grid>
        </Border>
    </Grid>
</Window>